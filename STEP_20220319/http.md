# http

### (1) http 相关概念

- 含义
  - http 是 超文本传输协议，除了传输文本，还能传输图片，视频等资源
    - ht -> hyperText 超过 高 文本
    - t -> transfer 传输
    - p -> protocol
    - hyperText transfer protocol 超文本传输协议

### (2) tcp/ip 协议

- 分层
  - 应用层：http
  - 传输层：tcp udp
  - 网络层：ip
  - 数据链路层

### (3) tcp 报文

- 相关概念
  - 序号 Seq
  - 确认号 Ack
  - 标识位
    - ACK 确认
    - SYN 建立链接
    - FIN 释放链接
  - Ack = Seq + 1
  - 只有标识为 ACK=1 时，确认序号 Ack 字段才有效

### (4) tcp 三次握手 --- 由客户端发起

- 1. 客户端 -> 服务器端
  - 链接包：标志位 SYN=1，序号 Seq=x 的链接包
  - 发送后的状态：close -> syn_sent
  - 判断：服务器能判断 客户端的发送能力，自己的接收能力正常
- 2. 服务器端 -> 客户端
  - 确认包：标志位 SYN=1，ACK=1，确认号 Ack=x+1，序号 Seq=y 的确认包
  - 发送后的状态：close -> syn_received
  - 判断：客户端能判断 服务器的接收发送能力正常，自己的发送接收能力正常
- 3. 客户端 -> 服务器
  - 确认包：标志位 ACK=1，确认号 Ack=y+1，序号 Seq=x+1 的确认包
  - 发送后两者的状态都变成 established
  - 判断：服务器能判断 客户端的发送接收能力正常，自己的接收发送能力正常

### (5) tcp 四次挥手 --- 客户端和服务端都能发起

- 1. 客户端 -> 服务器端
  - 释放包：标志位 FIN=1，序号 Seq=u 的释放链接给服务器
  - 发送后的状态：客户端 established->finwait1 服务器 established->close_wait
  - 表明：客户端的报文发送完毕，但是还可以接收报文
- 2. 服务器 -> 客户端
  - 确认包：标志位 ACK=1，确认号 Ack=u+1，序号 Seq=v
  - 发送后的状态：服务器有 established->close_wait
- 3. 服务器 -> 客户端
  - 释放包：标志位 FIN=1，ACK=1，确认号 Ack=u+1，序号 Seq=w 的释放请求给客户端
  - 发送后的状态：服务器端 closeWait->lastAck
  - 表明：服务器报文发送完毕，但是服务器还可以接收报文
- 4. 客户端 -> 服务器
  - 确认包：标志位 ACk=1，确认号 Ack=w+1，序号 Seq=u+1
  - 发送后的状态：客户端进入 timeWait，timeWait 的时间至少是一个报文的 ( 来回时间 )

### (6) 一些重要的 http 状态码

- 100 continue 继续请求
- 101 switch protocol 客户端应该升级协议
- 200 ok
- 201 created post 请求资源创建成功
- 204 no content 请求成功，但是没有资源可以返回
- 206 partial content 范围请求
- 301 moved permanently 永久重定向
- 302 found 临时重定向
- 303 sea other 临时重定向，应该用 get
- 304 not modified 资源未被修改
- 307 temporary redirect 临时重定向
- 400 bad request
- 401 unauthorized 未授权
- 403 forbidden 禁止访问
- 404 not found 资源未找到
- 405 method not allow 请求方法错误
- 500 internal server error
- 502 bad Gateway 网关错误
- 503 service Unavailable 服务器过载
- 504 gateway time out 网关超时

### (7) http 的特点

- 缺点
  - 明文传播 ---------------> 窃听
  - 不验证通信双方的 身份 ----> 伪装 --------> 请求和响应都不会对通信双方的身份进行确认
  - 不验证报文的 完整性 ------> 篡改

### (8) 加密的对象有哪些

- 通信线路 的加密 -----------> http + ssl
- 通信内容 的加密

### (9) 常见的加密算法

- 总体上分为 可逆加密 和 不可逆加密

```
1. 可逆加密
- MD5，SHA
- SHA 是安全散列算法
- 由于这些加密都是不可逆的，因此比较常用的场景就是用户密码加密，其验证过程就是通过比较两个加密后的字符串是否一样来确认身份的


2. MD5加密的特点
- 压缩性：无论数据的长度是多少，MD5加密计算出来的值 ( 长度相同 )
- 容易计算性：由 原数据 容易计算出 MD5的值
- 抗修改性：即便只修改一个字符，计算出来的MD5值也差异巨大
- 抗碰撞性：知道数据和`MD5`值，很小概率找到相同`MD5`值相同的原数据
```

### (10) HTTP 报文

- 组成
  - 报文首部
  - 空行
  - 报文主体
- 请求报文首部 = 请求行 + 请求头
- 响应报文首部 = 状态行 + 响应头
- ( `请求报文 = 报文首部 + 空行 + 报文主体` )
- ( `请求报文 = 请求行 + 请求头 + 空行 + 报文主体` )

```
1. 请求报文
- 请求报文 = 报文首部 + 空行 + 报文主体
  - 请求报文首部 = 请求行 + 请求头
  - 响应博文首部 = 状态行 + 响应头

2. 报文首部
- 请求报文首部 = 请求行 + 请求头
- 响应博文首部 = 状态行 + 响应头

3. 请求行
- 请求行 = 请求的方法 + 请求的URI + HTTP的版本号

4. 状态行
- 状态行 = HTTP版本号 + 状态码 + 原因短语
```
