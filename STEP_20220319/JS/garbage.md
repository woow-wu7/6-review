# 垃圾回收机制

- 定义
  - 程序中 ( 不需要使用的对象 ) 会被认为是垃圾
  - 程序中 ( 不能访问到的对象 ) 会被认为是垃圾
- 一些名词
  - GC
    - garbage collection 垃圾回收
  - 可达对象
    - 从 ( 根对象 ) 出发，可以被访问到的对象是 ( 可达对象 )
- 常用的 gc 算法
  - 引用计数
  - 标记清除
  - 标记整理
  - 分代回收

### (1) 标记清除法

- 原理
  - 垃圾回收器会 ( 定期扫描 ) 对象是否被标记，没有被标记的对象将会被垃圾回收器回收
- 流程
  - 大体上分为 ( 标记 ) 和 ( 清除 ) 两个阶段
  - 1. 标记
    - ( 递归遍历 ) 每个根，( 标记 ) 所有的 ( 可达对象 - 可以被访问到的对象 )
  - 2. 清除
    - ( 递归遍历 ) 每个根，( 删除 ) 所有的不能访问到的对象，删除后，( 清除第一阶段的所有标记 )
  - 3. 回收
    - 删除后，需要回收对应的内存空间，把内存空间放入 ( 空闲链表 ) 中
  - 4. 重复以上步骤
- **优缺点**
  - 优点
    - 解决 ( 循环引用 ) 的问题
  - 缺点
    - 不会立即回收：不会立即回收垃圾对象，必须等到 ( 遍历完成后 ) 才会删除
    - 产生空间碎片化：标记清除法是会产生 ( 碎片化空间 )，即 ( 链表地址不连续 )

### (2) 数组 和 链表 的区别？

- 访问
  - 数组：的 ( 内存空间 ) 是连续的，访问时只需要 ( 计算偏移量 )，访问速度快 ---------------------------- 效率高
  - 链表：的 ( 内存空间 ) 不是连续的，每次访问都需要 ( 从头遍历 ) 通过指针去寻找位置，访问速度慢 ---------- 效率低
- 添加和删除
  - 数组：添加和删除元素，需要移动其他元素来的内存空间 ( 比如删除时，需要移动后面的元素占据之前的位置 ) ------ 效率低
  - 链表：添加和删除元素，只需要 ( 改变节点对象的指针指向 )，不会去移动节点的内存空间，-------------------- 效率高
